YUI.add("flickr-photos-setSafetyLevel-updater",function(e,t){"use strict";function n(n,r){var i={};return n.fullResponse?(i.photo_ids=n.photoId,i.full_response=1):i.photo_id=n.photoId,i.safety_level=n.safetyLevel+1,r.callAPI("flickr.photos.setSafetyLevel",i).then(function(e){if("errors"in e)return e.api="setSafety",e},function(e){throw n.fullResponse&&(e.photoIds=n.photoId,e.returnApi="setSafety"),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photos-setSafetyLevel"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("photo-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[];return("title"in n||"description"in n)&&r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,title:n.title?n.title.newVal:this.getValue(t,"title"),description:n.description?n.description.newVal:this.getValue(t,"description")},this.appContext)),"license"in n&&r.push(e.ModelUpdaters["flickr-photos-licenses-setLicense"].run({photoId:t,license:n.license.newVal},this.appContext)),"safetyLevel"in n&&r.push(e.ModelUpdaters["flickr-photos-setSafetyLevel"].run({photoId:t,safetyLevel:n.safetyLevel.newVal},this.appContext)),e.Promise.all(r)},batchUpdate:function(t,n){var r=[];return"safetyLevel"in n&&r.push(e.ModelUpdaters["flickr-photos-setSafetyLevel"].run({photoId:t,safetyLevel:parseInt(n.safetyLevel,10),fullResponse:1},this.appContext)),"title"in n&&"description"in n?r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,title:n.title,description:n.description,fullResponse:1},this.appContext)):"title"in n?r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,title:n.title,fullResponse:1},this.appContext)):"description"in n&&r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,description:n.description,fullResponse:1},this.appContext)),"license"in n&&r.push(e.ModelUpdaters["flickr-photos-licenses-setLicense"].run({photoId:t,license:n.license,fullResponse:1},this.appContext)),e.Promise.all(r)}},getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,getSizeForCanvas:e.PhotoModelHelper.getSizeForCanvas,getGuestpass:function(t){var n=this;return new e.Promise(function(e,r){n.getValue(t,"guestpass")?e():n.appContext.callAPI("flickr.sharing.createGuestpass",{photo:t}).then(function(r){n.setValue(t,"guestpass",r.guestpass.url),e()})})},canVr:function(t){var n=this,r,i=!1;return this.appContext.flipper.isFlipped("enable-vr")?(n&&(r=n.getValue(t,"aspectRatio"),r&&r>=1.99&&r<=2.01&&(i=!0)),i?e.Promise.all([this.appContext.callAPI("flickr.vr.isEquirectangular",{photo_id:t})]).then(function(t){return e.Promise.resolve(!!t[0].is_equirectangular)}):e.Promise.resolve(!1)):e.Promise.resolve(!1)},attributes:{title:e.PhotoModelHelper.attributes.title,description:e.PhotoModelHelper.attributes.description,mediaType:e.PhotoModelHelper.attributes.mediaType,license:e.PhotoModelHelper.attributes.license,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,canPublicComment:e.PhotoModelHelper.attributes.canPublicComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation,owner:{isModel:!0},engagement:{isModel:!0},isHD:{},secret:{},canAddMeta:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!0},isMarketplacePrintable:{defaultFn:function(e){return!1}},isMarketplaceLicensable:e.PhotoModelHelper.attributes.isMarketplaceLicensable,marketplaceLicensingUrl:e.PhotoModelHelper.attributes.marketplaceLicensingUrl,oWidth:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},oHeight:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},safetyLevel:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},guestpass:{},hasInvalidColorspaceForPrint:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},sizesForAlbum:{readOnly:!0,derivedBy:["sizes"],defaultFn:function(t){var n=this.getValue(t,"sizes");return e.Object.each(n,function(e,t){e.src=e.url}),n}},stats:{isModel:!0},curation:{isModel:!0},visibilitySource:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:1},isVideoPending:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","photo-model-helper","photo-curation-models","flickr-photos-getInfo-fetcher","flickr-photos-setPerms-updater","flickr-photos-setMeta-updater","flickr-photos-licenses-setLicense-updater","flickr-photos-setSafetyLevel-updater","attribute-helpers"]});
YUI.add("notification-group-discussion-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,parseDiscussionModel:function(t,n,r,i){var s={id:t,pathAlias:n,title:r.name,replyCount:r.replies,groupID:r.group_id,groupName:r.groupName,iconUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(r.iconurls),coverPhotoUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(r.coverphoto_url),group:i};return s},attributes:{id:{},pathAlias:{},title:{},replyCount:{},groupID:{},groupName:{},iconUrls:{},coverPhotoUrls:{},url:{readOnly:!0,derivedBy:["id","groupID"],defaultFn:function(e){return"/groups/"+this.getValue(e,"groupID")+"/discuss/"+e}},groupUrl:{readOnly:!0,derivedBy:["id","groupID"],defaultFn:function(e){return"/groups/"+this.getValue(e,"groupID")}},group:{isModel:!0}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-gallery-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,parseGalleryModel:function(t){var n={id:t.id,pathAlias:t.pathalias,title:t.title._content,iconUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(t.iconurls),owner:{id:t.owner,username:t.ownername,displayname:t.realname}};return n},attributes:{id:{},title:{},pathAlias:{},url:{readOnly:!0,derivedBy:["id","owner","pathAlias"],defaultFn:function(e){var t=this.getValue(e,"pathAlias")||this.getValue(e,"owner").id;return"/photos/"+t+"/galleries/"+e}},iconUrls:{},owner:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-fave-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{id:{},type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-comment-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{id:{},type:{},owner:{isModel:!0},timestamp:{},content:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-follower-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-added-to-gallery-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},gallery:{},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-people-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},personTagged:{isModel:!0},tagger:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-tag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-photo-comment-mention-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-photo-group-invite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},group:{id:"",name:""},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-group-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-note-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-share-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("notification-event-group-reply-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{type:{},owner:{isModel:!0},timestamp:{},replyId:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("flickr-notifications-markread-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.notifications.markread",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-notifications-markread"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-activity-getNotificationsCount-fetcher",function(e,t){"use strict";function n(e,t,n){var r=e.apiResponse,i=e.personNotifsModelRegistry;return i.setValue(n.id,"unseenNotificationCount",r.activity.count),r.activity.count}function r(n,r){var i=this;return e.FlickrPromise({apiResponse:r.callAPI("flickr.activity.getNotificationsCount",n),personNotifsModelRegistry:r.getModelRegistry("person-notifications-models")}).then(function(e){return i._processResponse(e,r,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-activity-getNotificationsCount"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:["person-notifications-models","api-helper"]});
YUI.add("person-notifications-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},readUnseenNotificationCount:function(t,n){return e.ModelFetchers["flickr-activity-getNotificationsCount"].run(t,n)}},remoteReadUnseenNotificationCount:function(e,t,n){return this.setValue(e,"unseenLastFetchedTimestamp",Date.now()),this.remote.readUnseenNotificationCount(t,n)},attributes:{id:{setter:function(e){return e||this.appContext.getViewer().nsid}},unseenNotificationCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},unreadFlickrMailCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},unseenLastFetchedTimestamp:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},notifications:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-activity-recentByType"]}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-activity-recentByType-fetcher","flickr-notifications-markread-updater","flickr-people-getInfo-fetcher","flickr-activity-getNotificationsCount-fetcher","attribute-helpers"]});

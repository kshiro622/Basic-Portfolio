YUI.add("hermes-template-notification-friend-join",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'<div class="notification">\n	\n	<a class="avatar person tiny no-menu" style="background-image: url('+u(o((s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.buddyicon:s,t))+');" href="'+u(o((s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.profileURL:s,t))+'"></a>\n\n	<div class="details">\n		<span class="headline">\n			'+u((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{personUrl:(s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.profileURL:s,personName:(s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.displayname:s,intlName:"notifications.NOTIF_FRIEND_JOIN"},data:i}))+"\n		</span>\n\n"+((s=e.invokePartial(r["notification-photo-extra-info"],t,{name:"notification-photo-extra-info",data:i,indent:"		",helpers:n,partials:r,decorators:e.decorators}))!=null?s:"")+"	</div>\n</div>"},usePartial:!0,useData:!0}),r={};e.Array.each(["notification-photo-extra-info"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/notification-friend-join",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-notification-photo-extra-info"]});
YUI.add("hermes-template-notification-group-topic-new",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'<div class="notification">\n	\n	<a class="avatar person tiny no-menu" style="background-image: url('+u(o((s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.buddyicon:s,t))+');" href="'+u(o((s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.profileURL:s,t))+'"></a>\n\n	<div class="details">\n		<span class="headline">\n			'+u((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{groupUrl:(s=(s=t!=null?t.object:t)!=null?s.group:s)!=null?s.url:s,groupName:(s=(s=t!=null?t.object:t)!=null?s.group:s)!=null?s.title:s,discussionUrl:(s=t!=null?t.object:t)!=null?s.url:s,discussionName:(s=t!=null?t.object:t)!=null?s.title:s,personUrl:(s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.profileURL:s,personName:(s=(s=t!=null?t.event:t)!=null?s.owner:s)!=null?s.displayname:s,intlName:"notifications.NOTIF_NEW_GROUP_DISCUSSION"},data:i}))+"\n		</span>\n\n"+((s=e.invokePartial(r["notification-photo-extra-info"],t,{name:"notification-photo-extra-info",data:i,indent:"		",helpers:n,partials:r,decorators:e.decorators}))!=null?s:"")+"	</div>\n</div>"},usePartial:!0,useData:!0}),r={};e.Array.each(["notification-photo-extra-info"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/notification-group-topic-new",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-notification-photo-extra-info"]});
YUI.add("notification-view",function(e){var t=e.flutil;e.namespace("Views")[this.name]=e.Base.create("notification-view",e.FlickrView,[],{langBundles:this.details.langBundles,registries:{person:"person-models",photo:"photo-models",group:"group-info-models"},initializer:function(e){return this.objectId=e.objectId,this.object=e.object,this.objectType=e.objectType,this.subevents=e.events,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e={object:this.object,type:this.objectType,event:this.subevents[0],subCount:this.subevents.length-1,viewer:this.appContext.getViewer(),eventCount:this.subevents.length,events:this.subevents},n;if(this.objectType==="photo"){for(var r=0;r<e.events.length;r++)e.events[r].owner.url="/photos/"+e.events[r].owner.pathAlias||e.events[r].owner.id;e.event.type!=="group-invite"&&(e.people=this.getEventOwners(e.events),e.peopleCount=e.people.length,e.subPeopleCount=e.people.length-1);if(e.event.type==="comment")n="notification-photo-comment";else if(e.event.type==="fave")n="notification-photo-fave";else{if(e.event.type==="gallery")return n="notification-added-to-gallery",this.setContainerWithTemplate(n,e),this;if(e.event.type==="people")n="notification-person";else if(e.event.type==="tag")n="notification-tag";else if(e.event.type==="photo_comment_mention")n="notification-mention";else{if(e.event.type==="group_invite")return e.groups=this.getEventGroups(e.events),e.groupsCount=e.groups.length,e.subGroupsCount=e.groups.length-1,n="notification-photo-group-invite",this.setContainerWithTemplate(n,e),this;e.event.type==="note"?n="notification-photo-note":e.event.type==="share"&&(n="notification-photo-share")}}}else if(this.objectType==="person"){if(e.event&&e.event.type==="contacted")return e.event.owner.url="/photos/"+e.event.owner.pathAlias||e.event.owner.id,this.setContainerWithTemplate("notification-person-follow",e),this;e.event&&e.event.type==="friend_join"&&this.setContainerWithTemplate("notification-friend-join",e)}else{if(this.objectType==="group")return e.event&&e.event.type==="group_user_invite"&&this.setContainerWithTemplate("notification-group-invite",e),this;if(this.objectType==="discussion")return e.event&&(e.event.type==="topic_reply"||e.event.type==="reply_reply")&&(e.people=this.getEventOwners(e.events),e.peopleCount=e.people.length,e.subPeopleCount=e.people.length-1,e.replyUrl=e.object.url+"/"+e.event.replyId,this.setContainerWithTemplate("notification-group-discussion-reply",e)),e.event&&e.event.type==="group_topic_new"&&this.setContainerWithTemplate("notification-group-topic-new",e),this;this.objectType==="gallery"&&e.event.type==="comment"&&(e.people=this.getEventOwners(e.events),e.peopleCount=e.people.length,e.subPeopleCount=e.people.length-1,this.setContainerWithTemplate("notification-gallery-comment",e))}return n&&this.setContainerWithTemplate("notification-shell",t.extend({details:this.templates(n)(e)},e)),this},activate:function(){return this},headline:function(){},getTaggedPeople:function(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n],i={id:r.personTagged.id,name:r.personTagged.displayname,url:r.personTagged.profileURL},s=!1;for(var o=0;o<t.length;o++)if(t[o].id===i.id){s=!0;break}s||t.push(i)}return t},getEventOwners:function(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n],i={id:r.owner.id,name:r.owner.displayname,url:r.owner.profileURL},s=!1;for(var o=0;o<t.length;o++)if(t[o].id===i.id){s=!0;break}s||t.push(i)}return t},getEventGroups:function(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n],i={id:r.group.id,title:r.group.title,url:r.group.url,iconUrl:r.group.bestIconURL},s=!1;for(var o=0;o<t.length;o++)if(t[o].id===i.id){s=!0;break}s||t.push(i)}return t}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","hermes-template-notifications","hermes-template-notification-photo-comment","hermes-template-notification-group-invite","hermes-template-notification-added-to-gallery","hermes-template-notification-photo-fave","hermes-template-notification-shell","hermes-template-notification-person-follow","hermes-template-notification-tag","hermes-template-notification-person","hermes-template-notification-mention","hermes-template-notification-photo-group-invite","hermes-template-notification-photo-extra-info","hermes-template-notification-photo-note","hermes-template-notification-photo-share","hermes-template-notification-group-discussion-reply","hermes-template-notification-gallery-comment","hermes-template-notification-friend-join","hermes-template-notification-group-topic-new"],langBundles:["common","relative-dates","notifications"]});
YUI.add("hermes-lang-relative-dates",function(e,t){e.Intl.add("hermes/relative-dates","en-US",{SECOND_LONG:["1 second"],SECONDS_LONG:["${time}"," seconds"],MINUTE_LONG:["1 min"],MINUTES_LONG:["${time}"," mins"],HOUR_LONG:["1 hour"],HOURS_LONG:["${time}"," hours"],DAY_LONG:["1 day"],DAYS_LONG:["${time}"," days"],MONTH_LONG:["1 month"],MONTHS_LONG:["${time}"," months"],YEAR_LONG:["1 year"],YEARS_LONG:["${time}"," years"],SECOND_SHORT:["1s"],SECONDS_SHORT:["${time}","s"],MINUTE_SHORT:["1m"],MINUTES_SHORT:["${time}","m"],HOUR_SHORT:["1h"],HOURS_SHORT:["${time}","h"],DAY_SHORT:["1d"],DAYS_SHORT:["${time}","d"],MONTH_SHORT:["1mo"],MONTHS_SHORT:["${time}","mo"],YEAR_SHORT:["1y"],YEARS_SHORT:["${time}","y"],SECOND_LONG_FUTURE:["in 1 second"],SECONDS_LONG_FUTURE:["in ","${time}"," seconds"],MINUTE_LONG_FUTURE:["in 1 min"],MINUTES_LONG_FUTURE:["in ","${time}"," mins"],HOUR_LONG_FUTURE:["in 1 hour"],HOURS_LONG_FUTURE:["in ","${time}"," hours"],DAY_LONG_FUTURE:["in 1 day"],DAYS_LONG_FUTURE:["in ","${time}"," days"],MONTH_LONG_FUTURE:["in 1 month"],MONTHS_LONG_FUTURE:["in ","${time}"," months"],YEAR_LONG_FUTURE:["in 1 year"],YEARS_LONG_FUTURE:["in ","${time}"," years"],FUTURE_SHORT_FUTURE:["in ","${time}"],SECOND_SHORT_FUTURE:["in 1s"],SECONDS_SHORT_FUTURE:["in ","${time}","s"],MINUTE_SHORT_FUTURE:["in 1m"],MINUTES_SHORT_FUTURE:["in ","${time}","m"],HOUR_SHORT_FUTURE:["in 1h"],HOURS_SHORT_FUTURE:["in ","${time}","h"],DAY_SHORT_FUTURE:["in 1d"],DAYS_SHORT_FUTURE:["in ","${time}","d"],MONTH_SHORT_FUTURE:["in 1mo"],MONTHS_SHORT_FUTURE:["in ","${time}","mo"],YEAR_SHORT_FUTURE:["in 1y"],YEARS_SHORT_FUTURE:["in ","${time}","y"],SECOND_LONG_PAST:["1 second ago"],SECONDS_LONG_PAST:["${time}"," seconds ago"],MINUTE_LONG_PAST:["1 min ago"],MINUTES_LONG_PAST:["${time}"," mins ago"],HOUR_LONG_PAST:["1 hour ago"],HOURS_LONG_PAST:["${time}"," hours ago"],DAY_LONG_PAST:["1 day ago"],DAYS_LONG_PAST:["${time}"," days ago"],MONTH_LONG_PAST:["1 month ago"],MONTHS_LONG_PAST:["${time}"," months ago"],YEAR_LONG_PAST:["1 year ago"],YEARS_LONG_PAST:["${time}"," years ago"],SECOND_SHORT_PAST:["1s ago"],SECONDS_SHORT_PAST:["${time}","s ago"],MINUTE_SHORT_PAST:["1m ago"],MINUTES_SHORT_PAST:["${time}","m ago"],HOUR_SHORT_PAST:["1h ago"],HOURS_SHORT_PAST:["${time}","h ago"],DAY_SHORT_PAST:["1d ago"],DAYS_SHORT_PAST:["${time}","d ago"],MONTH_SHORT_PAST:["1mo ago"],MONTHS_SHORT_PAST:["${time}","mo ago"],YEAR_SHORT_PAST:["1y ago"],YEARS_SHORT_PAST:["${time}","y ago"],NO_DATE:["-"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-notifications",function(e,t){e.Intl.add("hermes/notifications","en-US",{NOTIF_PHOTO_FAVE:["<a href='","${ownerUrl}","'>","${owner}","</a> faved your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_PHOTO_FAVE_MULTI:[{type:"plural",valueName:"count",options:{one:["<a href='","${ownerUrl}","'>","${owner}","</a> and <a href='","${secondUrl}","'>","${secondOwner}","</a> faved your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}],other:["<a href='","${ownerUrl}","'>","${owner}","</a> and ","${count}"," others faved your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}]}},"."],NOTIF_PERSON_FOLLOW:["<a href='","${ownerUrl}","'>","${owner}","</a> is now following you!"],NOTIF_PHOTO_COMMENT_YOURS:['<a href="',"${personUrl}",'">',"${personName}","</a> commented on your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_PHOTO_COMMENT_YOURS_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> commented on your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}],other:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}","</a> and ","${count}"," others commented on your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}]}},"."],NOTIF_PHOTO_COMMENT_OTHER:['<a href="',"${personUrl}",'">',"${personName}",'</a> commented on <a href="',"${ownerUrl}",'">',"${ownerName}","'s</a> ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_PHOTO_COMMENT_OTHER_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}",'</a> commented on <a href="',"${ownerUrl}",'">',"${ownerName}","'s</a> ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}],other:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}","</a> and ","${count}",' others commented on <a href="',"${ownerUrl}",'">',"${ownerName}","'s</a> ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}]}},"."],NOTIF_MENTION:['<a href="',"${personUrl}",'">',"${personName}","</a> mentioned you in a ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_MENTION_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a>"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}"," others"]}}," mentioned you in a ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_PHOTO_GROUP_INVITE:["<a href='","${ownerUrl}","'>","${owner}","</a> invited you to add your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}," to the group <a href='","${groupUrl}","'>","${groupName}","</a>."],NOTIF_PHOTO_GROUP_INVITE_MULTI:["You've been invited to add your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}," to the ",{type:"plural",valueName:"count",options:{one:["groups <a href='","${groupUrl}","'>","${groupName}","</a> and <a href='","${secondGroupUrl}","'>","${secondGroupName}","</a>"],other:["group <a href='","${groupUrl}","'>","${groupName}","</a> and ","${count}"," other groups"]}},"."],NOTIF_GROUP_USER_INVITE:["You've been invited to join the group <a href=\"","${groupUrl}",'">',"${groupName}","</a>."],NOTIF_TAGS:['<a href="',"${personUrl}",'">',"${personName}","</a> tagged your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_TAGS_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a>"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}"," others"]}}," tagged your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_GALLERY:["Your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},' was added to the gallery <a href="',"${galleryUrl}",'">',"${galleryName}","</a>."],NOTIF_GALLERY_MULTI:["Your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}," was added to the ",{type:"plural",valueName:"count",options:{one:['galleries <a href="',"${galleryUrl}",'">',"${galleryName}",'</a> and <a href="',"${secondGalleryUrl}",'">',"${secondGalleryName}","</a>"],other:['gallery <a href="',"${galleryUrl}",'">',"${galleryName}","</a> and ","${count}"," other galleries"]}},"."],NOTIF_ADD_PERSON:['<a href="',"${personUrl}",'">',"${personName}","</a> tagged people in your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_ADD_PEOPLE:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a>"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}"," others"]}}," tagged people in your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_ADD_ME:['<a href="',"${ownerUrl}",'">',"${ownerName}","</a> tagged you in a ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_NOTES:['<a href="',"${personUrl}",'">'
,"${personName}","</a> left a note on your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_NOTES_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a>"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}"," others"]}}," left notes on your ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}},"."],NOTIF_VIEW_RECENT_ACTIVITY:["View Recent Activity"],NOTIFICATIONS:["Notifications"],NOTIF_SHARE:['<a href="',"${personUrl}",'">',"${personName}","</a> shared a ",{type:"select",valueName:"mediaType",options:{photo:["photo"],video:["video"],other:["photo"]}}," with you."],FLICKR_MAIL_COUNT_PAREN:["(","${count}",")"],FLICKR_GROUP_DISCUSSION_REPLY:['<a href="',"${personUrl}",'">',"${personName}",'</a> replied to the discussion <a href="',"${replyUrl}",'">',"${objectTitle}",'</a> in the group <a href="',"${groupUrl}",'">',"${groupName}","</a>."],FLICKR_GROUP_DISCUSSION_REPLY_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a>"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}"," others"]}},' replied to the discussion <a href="',"${replyUrl}",'">',"${objectTitle}",'</a> in the group <a href="',"${groupUrl}",'">',"${groupName}","</a>."],NOTIF_GROUP_DISCUSSION_REPLY:['<a href="',"${personUrl}",'">',"${personName}",'</a> replied to the discussion <a href="',"${replyUrl}",'">',"${objectTitle}",'</a> in the group <a href="',"${groupUrl}",'">',"${groupName}","</a>."],NOTIF_GROUP_DISCUSSION_REPLY_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a>"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}"," others"]}},' replied to the discussion <a href="',"${replyUrl}",'">',"${objectTitle}",'</a> in the group <a href="',"${groupUrl}",'">',"${groupName}","</a>."],NOTIF_ONBOARDING_TITLE:["NEW \u2014 Notification Center"],NOTIF_ONBOARDING_DESCRIPTION:["Here, you'll find notifications of your recent activity on Flickr. This includes easy access to <a href=\"/mail\">FlickrMail</a>. We think you'll enjoy what we've built so far."],NOTIF_GALLERY_COMMENT:['<a href="',"${personUrl}",'">',"${personName}",'</a> commented on your gallery <a href="',"${objectUrl}",'">',"${objectName}","</a>."],NOTIF_GALLERY_COMMENT_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> and <a href="',"${secondPersonUrl}",'">',"${secondPersonName}",'</a> commented on your gallery <a href="',"${objectUrl}",'">',"${objectName}","</a>."],other:['<a href="',"${personUrl}",'">',"${personName}","</a> and ","${count}",' others commented on your gallery <a href="',"${objectUrl}",'">',"${objectName}","</a>."]}}],NOTIF_FRIEND_JOIN:['Your friend <a href="',"${personUrl}",'">',"${personName}","</a> joined Flickr!"],NOTIF_NEW_GROUP_DISCUSSION:['<a href="',"${personUrl}",'">',"${personName}",'</a> created the discussion <a href="',"${discussionUrl}",'">',"${discussionName}",'</a> in the group <a href="',"${groupUrl}",'">',"${groupName}","</a>."],NOTIF_FLICKRMAIL:['<a href="',"${personUrl}",'">',"${personName}",'</a> sent you a message: <a href="',"${mailUrl}",'">\u201c',"${mailTitle}","\u201d</a>"],NOTIF_TURN_OFF_OBJECT:["Turn off notifications for this post"],NOTIF_TURN_ON_OBJECT:["Turn on notifications for this post"],NOTIF_HIDE_THIS:["Hide this notification"]})},"@VERSION@",{requires:["intl"]});
YUI.add("flickr-galleries-getContext-fetcher",function(e,t){"use strict";function n(t){var n={gallery_id:t.compoundId,photo_id:t.photoId,extras:e.APIHelper.request.getRebootPhotoExtras(),num_prev:t.numPrev,num_next:t.numNext};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.nextphotos,d=r.prevphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),y=i.getValue(n.id,"photoContextList"),m=y.hasMinBoundary?y.hasMinBoundary():!1,g=y.hasMaxBoundary?y.hasMaxBoundary():!1,v=y.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),current:v,hasMin:m,hasMax:g,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.galleries.getContext",this._processParams(n),!0),r.getModelRegistry("gallery-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===3&&e.message==="Photo not in gallery"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-galleries-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["gallery-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("photo-contexts-models",function(e){function t(e){t.superclass.constructor.call(this,e),this.getMorePromises={"group-pool-models":{},"set-models":{},"gallery-models":{}},this.continuationKeys={"group-pool-models":{},"set-models":{},"gallery-models":{}}}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return this.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext):e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},getMoreContextsOfType:function(t,n,r){var i=this,s,o,u,a,f,l,c,h="-1",p=e.APIHelper.request.getRebootPhotoExtras();switch(n){case"group-pool-models":s="flickr.photos.getGroups",u="groups.group",p+=","+e.APIHelper.request.getRebootGroupExtras();break;case"set-models":s="flickr.photos.getSets",u="sets.set";break;case"gallery-models":s="flickr.photos.getGalleries",u="galleries.gallery"}return s?this.exists(t)?(a=this.continuationKeys[n][t]||"0",a===h?e.Promise.resolve({type:n,newContexts:[],loadedAll:!0}):(o={photo_id:t,extras:p,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:a,per_page:r},l=t+"_"+a,c=this.getMorePromises[n][l],c?c:(this.getMorePromises[n][l]=(new e.FlickrPromise({apiResponse:this.appContext.callAPI(s,o,!0),contextRegistry:this.appContext.getModelRegistry(n),personRegistry:this.appContext.getModelRegistry("person-models")})).then(function(r){var s=[],o=r.apiResponse,a=r.contextRegistry,c=r.personRegistry,p,d,v;return d=u.split(".").reduce(function(t,n){return e.Lang.isObject(t)?t[n]:undefined},o),d&&(e.Array.each(d,function(t){e.APIHelper.response.addContextToRegistry(t,a,c),s.push(a.proxy(t.id))}),s.length&&(v=i.getContextsOfType(t,n).map(function(e){return e.getValue("id")}),s=s.filter(function(e){return v.indexOf(e.getValue("id"))===-1}),s.length&&i.getValue(t,"contexts").appendToListMulti(s))),f=o.continuation,typeof f=="undefined"?f=h:e.Lang.isNumber(f)&&(f+=""),p=f===h,i.continuationKeys[n][t]=f,delete i.getMorePromises[n][l],{type:n,newContexts:s,loadedAll:p}}),this.getMorePromises[n][l]))):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called for an ID that isn't in the registry: "+t):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called without an invalid type: "+n)},getContextsOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)>-1})},getContextsNotOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)===-1})},attributes:{contexts:{isCollection:!0},totalGroups:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalSets:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalGalleries:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-favorites-getContext-fetcher",function(e,t){"use strict";function n(t){var n={photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()};return t.id?n.user_id=t.id:n.path_alias=t.pathAlias,n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.prevphotos,d=r.nextphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),y=i.getValue(n.id,"photoContextList"),m=y.hasMinBoundary?y.hasMinBoundary():!1,g=y.hasMaxBoundary?y.hasMaxBoundary():!1,v=y.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),hasMax:g,hasMin:m,current:v,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.favorites.getContext",this._processParams(n),!0),r.getModelRegistry("favorite-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===3&&e.message==="Photo not a favorite"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-favorites-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["favorite-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-favorites-getList-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage||20,page:t.page||1,get_user_info:1,jump_to:t.withPhotoId||""};if(t.id||t.userId)n.user_id=(t.id||t.userId).split("-")[0];else{if(!t.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");n.path_alias=t.pathAlias}return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c={id:r.user.nsid,pathAlias:r.user.pathAlias,totalItems:r.photos.total},h,p=n.id||n.userId;return p&&p!==c.id&&(c.id=p),h=e.APIHelper.response.parsePerson(r.user),c.owner=s.addOrUpdate(h),l=e.APIHelper.response.parsePhotos({photos:r.photos.photo,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),c.photoPageList={perPage:r.photos.perpage,page:r.photos.page,pageContent:l,totalItems:r.photos.total},o.addOrUpdate(c),l}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.favorites.getList",this._processParams(n)),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("favorite-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-favorites-getList"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","favorite-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("favorite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-favorites-getList"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"favorites"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.appContext.getViewer(),n=this.getValue(e,"normalizedId"),r;return t&&t.nsid===n?"Your favorites":(r=this.getValue(e,"owner"),r?r.getValue("displayname")+"'s favorites":"Favorites")}},pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-favorites-getList"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-favorites-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=this.getValue(e,"normalizedId"),r=t?t.getValue("pathAlias"):n;return"/photos/"+r+"/favorites/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=t.getValue("pathAlias");return"faves-"+n}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-favorites-getContext-fetcher","flickr-favorites-getList-fetcher","photo-model-helper"]});
YUI.add("hermes-lang-shared-entity",function(e,t){e.Intl.add("hermes/shared-entity","en-US",{USERNAME_HAS_SHARED_PHOTOS_ONLY:["${username}"," has shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," with you!"],USERNAME_HAS_SHARED_VIDEOS_ONLY:["${username}"," has shared ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}}," with you!"],USERNAME_HAS_SHARED_PHOTOS_VIDEOS:["${username}"," has shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," ",{type:"plural",valueName:"videoCount",options:{one:"and ${#} video",other:"and ${#} videos"}}," with you!"],OWNER_HAS_SHARED_PHOTOS_ONLY:["You have shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}},"."],OWNER_HAS_SHARED_VIDEOS_ONLY:["You have shared ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}},"."],OWNER_HAS_SHARED_PHOTOS_VIDEOS:["You have shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," ",{type:"plural",valueName:"videoCount",options:{one:"and ${#} video",other:"and ${#} videos"}},"."],VIEW_YOUR_SHARING_HISTORY:["View your sharing history"]})},"@VERSION@",{requires:["intl"]});
YUI.add("photo-sets-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},sets:{isListProxy:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-photosets-addPhoto-creator",function(e,t){"use strict";function n(n,r){var i={full_response:1},s=[],o=n.isMultiplePhotos?"photo_ids":"photo_id",u=n.photoID.split(",").length;return i[o]=n.photoID,i.photoset_id=n.setID,n.gpCode&&(i.gp_code=n.gpCode),n.gpOwner&&(i.gp_owner=n.gpOwner),n.shareCode&&(i.share_code=n.shareCode),s=[r.callAPI("flickr.photosets.addPhoto",i),r.getModel("set-models",n.setID),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(e){var t=e[0],r=e[1],i=e[2],s=e[3],o,a=t.errors,f=t.errors?t.errors.length:0;u-=f;if(t.stat==="ok")return n.isMultiplePhotos?r&&n.updateItemCounts&&(r.setValue("photoCount",r.getValue("photoCount")+n.numberOfPhotosSelected),r.setValue("videoCount",r.getValue("videoCount")+n.numberOfVideosSelected)):(o=e[4],r&&!r.hasPhoto(o.getValue("id"))&&(r.addPhoto(o),o.getValue("isVideo")?r.setValue("videoCount",r.getValue("videoCount")+1):r.setValue("photoCount",r.getValue("photoCount")+1))),i.exists(n.photoID)&&!i.getValue(n.photoID,"sets").getFromListByID(r.getValue("id"))&&(i.getValue(n.photoID,"sets").prependToList(r),i.setValue(n.photoID,"total",i.getValue(n.photoID,"total")+u)),s.exists(n.photoID)&&!s.getValue(n.photoID,"contexts").getFromListByID(r.getValue("id"))&&(s.setValue(n.photoID,"totalSets",s.getValue(n.photoID,"totalSets")+u),s.getValue(n.photoID,"contexts").push(r)),n.isMultiplePhotos?(f&&a.forEach(function(e){n.photosSelectedIds.indexOf(e.photo_id)!==-1?r.setValue("photoCount",r.getValue("photoCount")-1):r.setValue("videoCount",r.getValue("videoCount")-1)}),{errors:a,setModel:r}):r},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-addPhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-getList-fetcher",function(e,t){"use strict";function n(t){var n={primary_photo_extras:e.APIHelper.request.getRebootAlbumsListExtras(),page:t.page||1,per_page:t.perPage||500,get_user_info:1,extras:"can_share,can_download"};if(t.id)n.user_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");n.path_alias=t.pathAlias}return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r.photosets,a={},f=o.getValue("id"),l=[];if(u)return u.photoset&&e.Array.each(u.photoset,function(t,n){if(t.visibilityCanSeeSet!==0){var r={id:t.id,title:t.title.content,description:t.description.content,owner:o,primary:t.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(t),isAutoUploadSet:t.autoUpload,primaryNeedsInterstitial:t.needsInterstitial,photoCount:t.photos,videoCount:t.videos,totalCount:parseInt(t.photos,10)+parseInt(t.videos,10),viewCount:t.countViews,canShare:t.canShare,canDownload:t.canDownload};l.push(s.addOrUpdate(r))}}),a={id:f,pathAlias:o.getValue("pathAlias"),totalItems:r.photosets.total},a.albumsList={perPage:n.perPage,page:n.page,pageContent:l,totalItems:r.photosets.total},i.addOrUpdate(a),l}function i(n,r){var i=this,s=this._processParams(n);return e.Promise.all([r.callAPI("flickr.photosets.getList",s,!0),r.getModelRegistry("sets-models"),r.getModelRegistry("set-models"),r.getModel("person-models",n.id||{pathAlias:n.pathAlias})]).then(function(e){return n.perPage=s.per_page,n.page=s.page,i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getList"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["sets-models","set-models","person-models"]});
YUI.add("sets-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getList"].run(t,this.appContext)}},attributes:{id:{},pathAlias:{},albumsList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photosets-getList"]}},totalItems:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-getList-fetcher"]});
YUI.add("flickr-photosets-removePhoto-deletor",function(e,t){"use strict";function n(n,r){var i={full_response:1},s=[],o=n.isMultiplePhotos?"photo_ids":"photo_id",u=n.photoID.split(",").length;return i[o]=n.photoID,i.photoset_id=n.setID,s=[r.callAPI("flickr.photosets.removePhoto",i),r.getModel("set-models",n.setID),r.getModel("sets-models",r.getViewer().nsid,{page:1,perPage:r.flipper.isFlipped("enable-sets-list-loading-fix")?10:500}),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(e){var t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a;if(t.stat==="ok"){o.exists(n.photoID)&&o.getValue(n.photoID,"contexts").getFromListByID(n.setID)&&(o.setValue(n.photoID,"totalSets",o.getValue(n.photoID,"totalSets")-u),o.getValue(n.photoID,"contexts").removeFromList(n.setID)),s.exists(n.photoID)&&s.getValue(n.photoID,"sets").getFromListByID(n.setID)&&(s.setValue(n.photoID,"total",s.getValue(n.photoID,"total")-u),s.getValue(n.photoID,"sets").removeFromList(n.setID));if(r){n.isMultiplePhotos?r&&n.updateItemCounts&&(r.setValue("photoCount",r.getValue("photoCount")-n.numberOfPhotosSelected),r.setValue("videoCount",r.getValue("videoCount")-n.numberOfVideosSelected)):(a=e[5],r.hasPhoto(a.getValue("id"))&&r.removePhoto(a),a.getValue("isVideo")?r.setValue("videoCount",r.getValue("videoCount")-u):r.setValue("photoCount",r.getValue("photoCount")-u));if(r.getValue("totalCount")<1)return i.getValue("albumsList").remove(n.setID),r.registry.remove(n.setID),null}return r}},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-removePhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-delete-deletor",function(e,t){"use strict";function n(n,r){return n.photoset_id=n.setID,n.gpCode&&(n.gp_code=n.gpCode),n.gpOwner&&(n.gp_owner=n.gpOwner),n.shareCode&&(n.share_code=n.shareCode),r.callAPI("flickr.photosets.delete",n).then(function(e){if(e.code===1)throw new Error(e)}).catch(e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-photosets-delete-deletor"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-getPhotos-fetcher",function(e,t){"use strict";function n(t){t.page=t.page||1,t.perPage=t.perPage||100;var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage,page:t.page,get_user_info:1,primary_photo_extras:"url_c, url_h, url_k, url_l, url_m, url_n, url_o, url_q, url_s, url_sq, url_t, url_z, needs_interstitial, can_share",jump_to:t.withPhotoId||""};return t.gpCode&&t.gpCode!==null?(n.gp_code=t.gpCode,n.share_code=t.gpCode,n.gp_owner=t.gpOwner):n.photoset_id=t.id.split("-")[0],t.viewAs&&(n.view_as=t.viewAs),t.filter&&(n.privacy_filter=t.filter),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c,h,p,d,v,m=[],g=!1,y=!1,b=n.id;c=e.APIHelper.response.parsePerson(r.user),h=s.addOrUpdate(c),p={id:n.id,title:r.photoset.title,description:r.photoset.description,owner:h,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:r.photoset.isAutoUploadSet,isSharedEntity:r.photoset.hidden&&r.photoset.hidden===1,photoCount:r.photoset.photoCount,videoCount:r.photoset.videoCount,primaryNeedsInterstitial:r.photoset.needsInterstitial,totalCount:parseInt(r.photoset.photoCount,10)+parseInt(r.photoset.videoCount,10),photoList:[],viewCount:r.photoset.countViews,canShare:r.photoset.canShare,canDownload:r.photoset.canDownload},b&&b!==r.photoset.id&&(p.id=b),r.photoset.isAutoUploadSet==="1"&&(p.canShare=!1),o.exists(n.id)&&(d=o.getValue(n.id,"photoPageList"),g=d.hasMinBoundary?d.hasMinBoundary():!1,y=d.hasMaxBoundary?d.hasMaxBoundary():!1,m=d.getList()),v=e.APIHelper.response.parsePhotos({photos:r.photoset.photo,ownerID:r.photoset.owner,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),p.photoPageList=e.APIHelper.response.addOrReplaceListByPage({current:m,perPage:n.perPage,pageNum:n.page,hasMax:y,hasMin:g,totalItems:r.photoset.total,newPages:v}),p.photoPageList={perPage:r.photoset.perPage,page:r.photoset.page,pageContent:v,totalItems:r.photoset.total},p.photoList.length&&(p.primary=r.photoset.primary);var w={id:p.id,countPhotosFamily:r.photoset.countPhotosFamily,countPhotosFriend:r.photoset.countPhotosFriend,countPhotosPublic:r.photoset.countPhotosPublic,countPhotosFriendFamily:r.photoset.countPhotosFriendFamily,totalCount:r.photoset.countPhotosAll};return l.exists(w.id)?l.setValues(n.id,w):l.add(w),o.exists(p.id)?o.setValue(n.id,"photoPageList",p.photoPageList):o.add(p),v}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getPhotos",this._processParams(n),!0),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models"),r.getModelRegistry("album-privacy-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getPhotos"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","set-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-photosets-getContext-fetcher",function(e,t){"use strict";function n(t,n){var r={extras:e.APIHelper.request.getRebootPhotoExtras(),photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,get_photoset_info:1};return t.gpCode?(r.share_code=t.gpCode,r.share_owner=t.gpOwner,r.gp_code=t.gpCode,r.gp_owner=t.gpOwner):r.photoset_id=t.id,r}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.prevphotos,d=r.nextphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),g=i.getValue(n.id,"photoContextList"),v=g.hasMinBoundary?g.hasMinBoundary():!1,m=g.hasMaxBoundary?g.hasMaxBoundary():!1,y=g.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),current:y,hasMin:v,hasMax:m,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getContext",this._processParams(n,r),!0),r.getModelRegistry("set-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===2&&e.message==="Photo not in set"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-photosets-create-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.title=n.title,i.description=n.description,i.primary_photo_id=n.photoID,i.full_result=1,s=[r.callAPI("flickr.photosets.create",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid),r.getModel("sets-models",r.getViewer().nsid,{page:1,perPage:r.flipper.isFlipped("enable-sets-list-loading-fix")?10:500}),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(t){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f,l,c,h,p,d=1;return r.photoset.id?(n.isMultiplePhotos?n.numberOfPhotosSelected+n.numberOfVideosSelected===1?(h=r.photoset.photos,p=r.photoset.videos):r.photoset.photos?(h=r.photoset.photos,p=0):(p=r.photoset.videos,h=0):(l=t[6],h=r.photoset.photos,p=r.photoset.videos),f={id:r.photoset.id,title:r.photoset.title.content,photoPageList:n.isMultiplePhotos?[]:[l],photoContextList:n.isMultiplePhotos?[]:[l],owner:s,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:!1,photoCount:h,videoCount:p,totalCount:d,viewCount:r.countViews||0},i.add(f),c=i.proxy(r.photoset.id),o.getValue("albumsList").unshift(c),u.exists(n.photoID)&&!u.getValue(n.photoID,"sets").getFromListByID(c.getValue("id"))&&(u.getValue(n.photoID,"sets").prependToList(c),u.setValue(n.photoID,"total",u.getValue(n.photoID,"total")+1)),a.exists(n.photoID)&&!a.getValue(n.photoID,"contexts").getFromListByID(c.getValue("id"))&&(a.setValue(n.photoID,"totalSets",a.getValue(n.photoID,"totalSets")+1),a.getValue(n.photoID,"contexts").appendToList(c)),c):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-create"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-createHidden-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.photo_ids=n.photoIds,s=[r.callAPI("flickr.photosets.createHidden",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid)],e.Promise.all(s).then(function(e){var t=e[0],n=e[1],r=e[2],i,s;return t.stat==="ok"&&t.photoset.share_code?(i={id:t.photoset.share_code,shareCode:t.photoset.share_code,owner:r,gpCode:t.photoset.share_code,gpOwner:r.getValue("pathAlias")||r.getValue("nsid"),url:t.photoset.url,isAutoUploadSet:!1,isSharedEntity:!0,totalCount:t.photoset.count},n.add(i),s=n.proxy(i.id),s):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-createHidden"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
